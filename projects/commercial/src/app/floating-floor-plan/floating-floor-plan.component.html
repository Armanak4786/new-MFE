<div
  class="grid card collapse-box m-1 mb-0"
  [ngClass]="{ collapsed: isCollapsed }"
>
  <div class="col-3">
    <div class="asset-link-bg pb-3">
      <dropdown
        [options]="optionData"
        [value]="facilityTypeDropdown"
        [labelType]="'vertical'"
        (change)="onFrequencyChange($event)"
        [clearable]="false"
      ></dropdown>
      <br />

      <div class="flex mr-2 mt-4">
        <div
          class="chart-container flex align-items-center justify-content-center p-3 pt-0 ml-2 mr-2"
        >
          <p-chart
            type="doughnut"
            [data]="data"
            [options]="options"
            class="w-full"
          ></p-chart>
        </div>
        <div class="color-box-container flex flex-column mt-3">
          <div
            *ngFor="let label of data?.labels; let i = index"
            class="flex align-items-center"
          >
            <div class="color-box" [style.background-color]="colors[i]"></div>
            <text
              [mode]="'label'"
              [label]="label"
              [labelClass]="'label-xs'"
            ></text>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="col-9">
    <gen-table
      [columns]="floatingFloorTypeColumnDefs"
      [dataList]="visibleFloatingFloorDataList"
      [isScrollable]="'true'"
      [tableClass]="'border-round'"
      [tableStyle]="'stripped-rows'"
      (onCellClick)="onCellClick($event)"
      [bodyClass]="'text-xs row-class-assetlink'"
      [headingClass]="'tableHeader text-xs header-text-color'"
    ></gen-table>
    <div
      class="collapse-toggle-wrapper"
      *ngIf="dataListRemainingCount > 0 || !isCollapsed"
    >
      <div
        class="collapse-toggle-button"
        (click)="toggleCollapse()"
        [class.collapsed]="isCollapsed"
        [class.expanded]="!isCollapsed"
      >
        <span class="text-center label-xs toggle-text">
          {{ getToggleButtonText() | translate }}
        </span>
        <i class="pi text-center ml-1" [ngClass]="getToggleButtonIcon()"></i>
      </div>
    </div>
  </div>
</div>

<div class="grid mt-2">
  <div class="col-12 sm:col-12 md:col-12">
    <div class="flex justify-content-start flex-wrap">
      <div class="p-1" *ngIf="hasAccess('perform_requests')">
        <gen-button
          [btnType]="'non-bg-btn'"
          [btnLabel]="'drawdown_request'"
          class="text-xs"
          (onClick)="drawdownRequest()"
        ></gen-button>
      </div>
      <div class="p-1" *ngIf="hasAccess('perform_requests')">
        <gen-button
          [btnType]="'non-bg-btn'"
          [btnLabel]="'repayment_request'"
          class="text-xs"
          (click)="repaymentRequest()"
        ></gen-button>
      </div>
      <div class="p-1">
        <gen-button
          [btnType]="'non-bg-btn'"
          [btnLabel]="'request_history'"
          class="text-xs"
          (click)="requestHistory()"
        ></gen-button>
      </div>
    </div>
  </div>
</div>

<div class="grid mt-2">
  <div class="col-12 sm:col-12 md:col-8">
    <div class="flex justify-content-start flex-wrap">
      <div class="p-1">
        <gen-button
          [btnType]="
            currentComponent === 'FacilitySummary' ? 'bg-btn' : 'border-btn'
          "
          [btnLabel]="'facility_summary'"
          class="text-xs"
          (onClick)="showFacilitySummary()"
        ></gen-button>
      </div>
      <div class="p-1">
        <gen-button
          [btnType]="
            currentComponent === 'TransactionFlow' ? 'bg-btn' : 'border-btn'
          "
          [btnLabel]="'statement'"
          class="text-xs"
          (onClick)="showStatements()"
        ></gen-button>
      </div>
      <div class="p-1">
        <gen-button
          [btnType]="currentComponent === 'Documents' ? 'bg-btn' : 'border-btn'"
          [btnLabel]="'documents'"
          class="text-xs"
          (onClick)="showDocuments()"
        ></gen-button>
      </div>
    </div>
  </div>
  <div class="col-12 sm:col-12 md:col-4">
    <div
      class="flex justify-content-end flex-wrap"
      *ngIf="currentComponent == 'FacilitySummary'"
    >
      <div>
        <gen-button
          [btnType]="'non-bg-btn'"
          [btnWidth]="'full'"
          [btnLabel]="'export'"
          class="text-xs"
          [iconPos]="'left'"
          [btnIcon]="'pi pi-cloud-upload'"
          (click)="export()"
        ></gen-button>
      </div>
      <div>
        <gen-button
          [btnType]="'non-bg-btn'"
          [btnWidth]="'full'"
          [btnLabel]="'print'"
          class="text-xs"
          [iconPos]="'left'"
          [btnIcon]="'pi pi-print'"
          (click)="onPrint()"
        ></gen-button>
      </div>
    </div>
  </div>
</div>
<ng-container *ngIf="currentComponent == 'FacilitySummary'">
  <app-facility-summary
    [todaysActivityColDef]="todaysActivityColDef"
    [facilityType]="facilityType"
    [facilitySummaryDatalist]="facilitySummaryDatalist"
  ></app-facility-summary>
</ng-container>
<ng-container *ngIf="currentComponent === 'TransactionFlow'">
  <app-transaction-flow
    [transactionsColumnDef]="transactionsColumnDef"
    [transactionDataList]="transactionsDataList"
    [paymentColumnDefs]="paymentColumnDefs"
    [paymentDataList]="paymentDataList"
    [paymentNotYetAllocated]="paymentNotYetAllocated"
    [overDue]="overDue"
    #TransactionFlow
  ></app-transaction-flow>
</ng-container>
<ng-container *ngIf="currentComponent == 'Documents'">
  <app-documents
    [documentsColumnDefs]="documentsColumnDefs"
    [documentsDataList]="documentsDataList"
    (documentEmitter)="onDocumentClick($event)"
    (docUploadEmitter)="onDocUploadClick($event)"
  ></app-documents>
</ng-container>
<ng-container *ngIf="currentComponent == 'RequestHistory'">
  <app-wholesale-request-history
    [swapRequestList]="swapRequestList"
    [facilityType]="facilityType"
    [selectedSubFacility]="selectedSubFacility"
  ></app-wholesale-request-history>
</ng-container>
